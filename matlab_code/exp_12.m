XMin= 599435.5810000002;
YMin= 2358326.3035000004;
XMax= 599518.2827000003;
YMax= 2358386.9219000004;
[I,map] = imread('map_FF.png','png');
yImg = linspace(YMax, YMin, size(I, 1));
xImg = linspace(XMin, XMax, size(I, 2));
image(xImg, yImg, I, 'CDataMapping', 'scaled');
set(gca,'Ydir','normal');
hold on

truth = [
%    timestamp       x          y
    42537.43308	599452.0345	2358353.808
    42537.43316	599452.7489	2358354.179
    42537.43319	599455.6064	2358352.274
    42537.43323	599456.9029	2358349.442
    42537.43328	599458.2522	2358346.201
    42537.43337	599459.7353	2358342.464
    42537.43344	599459.4178	2358339.276
    42537.43351	599460.0263	2358335.823
    42537.43356	599463.2542	2358333.23
    42537.43363	599463.3601	2358337.027
    42537.43368	599463.069	2358339.858
    42537.43376	599459.8675	2358343.694
    42537.43391	599463.1748	2358348.642
    42537.43402	599467.8051	2358350.692
    42537.43411	599472.3559	2358353.669
    42537.43425	599477.8857	2358354.211
    42537.43435	599476.6157	2358350.957
    42537.43442	599476.6157	2358347.557
    42537.43448	599477.383	2358345.097
    42537.43453	599480.3463	2358347.451
    42537.43458	599478.997	2358349.978
    42537.43468	599477.5417	2358354.397
    42537.43476	599478.8911	2358356.328
    42537.43485	599482.9922	2358358.842
    42537.43495	599485.982	2358362.638
    42537.43502	599482.0132	2358367.004
    42537.4351	599480.0553	2358370.311
    42537.43515	599483.1245	2358370.841
    42537.43547	599484.0005	2358368.695
    42537.43554	599485.9319	2358362.689
    42537.43559	599492.0967	2358360.307
    42537.43578	599497.7268	2358361.961
    42537.43588	599502.7358	2358363.226
    42537.43598	599507.5512	2358362.922
    42537.43623	599506.8368	2358360.091
    42537.4363	599508.8212	2358358.133
    42537.4364	599508.4073	2358350.035
    
   ];

x= truth(:,2);
y= truth(:,3);
Y= dct(y);Y1=Y;Y1(11:end)=0;y1 = idct(Y1);
X= dct(x);X1=X;X1(11:end)=0;x1 = idct(X1);
%  plot(x1, y1);
  plot(x, y, '--b','LineWidth',2);




beacons = [
%Minor  x       y           floor
1	599468.358	2358372.647	0
2	599471.1361	2358373.771	0
3	599466.1752	2358367.09	0
4	599475.4356	2358374.499	0
5	599478.5445	2358366.429	0
6	599470.144	2358361.402	0
7	599477.0231	2358357.962	0
8	599482.7117	2358356.838	0
9	599472.8559	2358352.075	0
10	599468.4903	2358353.597	0
11	599467.3658	2358348.437	0
12	599462.1403	2358351.017	0
13	599451.5569	2358347.18	0
14	599460.0236	2358344.204	0
15	599454.1366	2358341.227	0
16	599448.0512	2358346.056	0
17	599450.7632	2358339.971	0
18	599452.3507	2358336.134	0
19	599458.5023	2358330.512	0
20	599464.6538	2358356.044	0
21	599466.1752	2358362.857	0
22	599484.6299	2358366.76	0
23	599490.8476	2358363.188	0
24	599496.7346	2358359.748	0
25	599489.1278	2358359.087	0
26	599501.4971	2358365.437	0
27	599507.2518	2358362.328	0
28	599504.7383	2358357.764	0
30	599507.5164	2358351.083	0
31	599508.6409	2358358.624	1
32	599503.3492	2358363.717	1
33	599503.9445	2358368.215	1
34	599499.6451	2358364.643	1
35	599493.0305	2358363.254	1
36	599492.5013	2358359.153	1
37	599485.0929	2358362.791	1
38	599482.1825	2358356.044	1
39	599479.4044	2358363.452	1
40	599477.5523	2358354.523	1
41	599470.2762	2358354.126	1
42	599469.2179	2358349.892	1
43	599463.9924	2358346.254	1
44	599461.9419	2358351.149	1
45	599459.0976	2358343.675	1
46	599452.0861	2358347.114	1
47	599448.3158	2358345.527	1
48	599454.2028	2358341.426	1
49	599451.9538	2358337.457	1
50	599493.7581	2358356.242	1
51	599498.3221	2358354.39	1
52	599488.7971	2358358.822	1
53	599456.7163	2358349.099	1
54	599449.7048	2358342.352	1
55	599506.3258	2358364.246	1
56	599479.6028	2358360.211	1
57	599462.8679	2358359.417	1
58	599459.3622	2358357.698	1
71	599509.3685	2358356.904	0
72	599458.7007	2358349.694	0
75	599476.3613	2358371.568	1
76	599485.6218	2358374.876	1
77	599486.4155	2358375.405	1
78	599495.5437	2358378.712	1
79	599496.7343	2358379.374	1
80	599505.4656	2358382.946	1
90	599456.5175	2358363.896	1
91	599448.0509	2358359.662	1
92	599437.4675	2358355.561	1
93	599446.5956	2358359.133	1
94	599457.3113	2358330.161	1
95	599457.7082	2358333.733	1
96	599467.1009	2358337.173	1
97	599468.953	2358337.569	1
98	599476.0967	2358342.067	1
99	599477.6842	2358341.538	1
100	599486.0186	2358346.565	1
101	599487.6061	2358344.845	1
102	599495.8082	2358349.476	1
103	599499.777	2358347.888	1
104	599507.7145	2358350.402	1
];


data = {
%id  timestamp  event(1:in, 0:out) triggered_by  covered_by

'y2GR5brhMt'	42537.4330555556	1	86	[86]
'K38hrBu99n'	42537.4330671296	1	89	[81 82 83 86 89]
'NVYFwuBgAP'	42537.4330671296	1	81	[81 86]
'S8Xlh7p3p9'	42537.4330671296	1	83	[81 82 83 86]
'sm9VASuDG4'	42537.4330671296	1	82	[81 82 86]
'ydSJGEXsdl'	42537.4330671296	1	96	[81 82 83 86 89 96]
'IB8QgyHgBl'	42537.4330787037	1	90	[81 82 83 86 88 89 90 96]
'nmExQx0FfB'	42537.4330787037	1	99	[81 82 83 86 88 89 90 96 99]
'yy65xTgQSp'	42537.4330787037	1	88	[81 82 83 86 88 89 96]
'nsv7MwR59C'	42537.4330902778	1	85	[81 82 83 85 86 88 89 90 96 99]
'dSX4HvZu2e'	42537.4331018518	1	87	[81 82 83 85 86 87 88 89 90 96 99]
'5mqh3kcskz'	42537.4331134259	1	48	[48 81 82 83 85 86 87 88 89 90 95 96 99]
'8XYg1IuGJB'	42537.4331134259	1	95	[81 82 83 85 86 87 88 89 90 95 96 99]
'9TYzPSfsMt'	42537.4331250000	1	97	[100 48 81 82 83 85 86 87 88 89 90 95 96 97 99]
'QRKMPWd89o'	42537.4331250000	1	100	[100 48 81 82 83 85 86 87 88 89 90 95 96 99]
'X0Fnt4sTHy'	42537.4331250000	1	84	[100 48 81 82 83 84 85 86 87 88 89 90 91 95 96 97 99]
'k20lp0vwTk'	42537.4331250000	1	91	[100 48 81 82 83 85 86 87 88 89 90 91 95 96 97 99]
'W7PaZe0MmA'	42537.4331365741	1	53	[100 48 53 81 82 83 84 85 86 87 88 89 90 91 95 96 97 99]
'MxJuVkNRel'	42537.4331712963	1	46	[100 46 48 53 81 82 83 84 85 86 87 88 89 90 91 95 96 97 99]
'TOWpsRs0hM'	42537.4332060185	0	88	[100 46 48 53 81 82 83 84 85 86 87 89 90 91 95 96 97 99]
'xT8boYRlRH'	42537.4332060185	0	90	[100 46 48 53 81 82 83 84 85 86 87 89 91 95 96 97 99]
'GrBQOQSRrF'	42537.4332175926	1	45	[100 42 45 46 48 53 81 82 83 84 85 86 87 89 91 95 96 97 99]
'QEkj0yvqBv'	42537.4332175926	1	42	[100 42 46 48 53 81 82 83 84 85 86 87 89 91 95 96 97 99]
'KMjJfU8ziO'	42537.4332291667	0	82	[100 42 45 46 48 49 53 81 83 84 85 86 87 89 91 95 96 97 99]
'hMhTjtXkHy'	42537.4332291667	1	49	[100 42 45 46 48 49 53 81 82 83 84 85 86 87 89 91 95 96 97 99]
'9JnUWhF65o'	42537.4332407407	0	85	[100 42 45 46 49 53 81 83 84 86 87 89 91 95 96 97 99]
'H8o1JBFSEQ'	42537.4332407407	0	48	[100 42 45 46 49 53 81 83 84 85 86 87 89 91 95 96 97 99]
'ZSF6pRbvwq'	42537.4332407407	1	75	[100 42 45 46 49 53 75 81 83 84 86 87 89 91 95 96 97 99]
'yhalai0x96'	42537.4332523148	0	53	[100 42 45 46 49 75 81 83 84 86 87 89 91 95 96 97 99]
'iBiBhnGdDd'	42537.4332754630	1	44	[100 42 44 45 46 49 75 81 83 84 86 87 89 91 95 96 97 99]
'4m0toQHL15'	42537.4332870370	1	98	[100 101 42 44 45 46 49 75 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'50jWch9QFI'	42537.4332870370	1	94	[100 101 42 44 45 46 49 75 81 83 84 86 87 89 91 94 95 96 97 99]
'8q24nAAutj'	42537.4332870370	1	90	[100 101 42 44 45 46 49 75 81 83 84 86 87 89 90 91 94 95 96 97 99]
'WiV0rWxVQn'	42537.4332870370	1	101	[100 101 42 44 45 46 49 75 81 83 84 86 87 89 91 95 96 97 99]
'q6hokDQ5is'	42537.4332870370	1	40	[100 101 40 42 44 45 46 49 75 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'1mJuHfBdOd'	42537.4332986111	1	43	[100 101 40 42 43 44 45 46 49 75 76 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'4BqYA73ZrG'	42537.4332986111	1	76	[100 101 40 42 44 45 46 49 75 76 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'Lj3GN9rcFB'	42537.4332986111	1	77	[100 101 40 42 43 44 45 46 48 49 75 76 77 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'Ok1NPSFMxN'	42537.4332986111	1	48	[100 101 40 42 43 44 45 46 48 49 75 76 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'elxzuJN6p4'	42537.4333101852	1	54	[100 101 40 42 43 44 45 46 48 49 54 75 76 77 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'gzMQGC1VaU'	42537.4333333333	0	42	[100 101 40 43 44 45 46 48 49 54 75 76 77 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'iznJlpTEcA'	42537.4333449074	0	49	[100 101 40 43 44 45 46 48 54 75 76 77 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'fBz7jiD3Vs'	42537.4333680556	1	57	[100 101 40 43 44 45 46 48 54 57 75 76 77 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'85AJCteRQF'	42537.4333796296	1	102	[100 101 102 40 43 44 45 46 48 54 57 75 76 77 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'hKhyrSQWBr'	42537.4334143518	0	40	[100 101 102 43 44 45 46 48 54 57 75 76 77 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'GPsx2XbThh'	42537.4334259259	0	75	[100 101 102 43 44 45 46 48 54 57 76 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'qHjT53wkZp'	42537.4334259259	0	77	[100 101 102 43 44 45 46 48 54 57 75 76 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'eFNv8C2W5x'	42537.4334490741	1	103	[100 101 102 103 43 44 45 46 48 54 57 76 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'liG6rvzZ3h'	42537.4334837963	0	57	[100 101 102 103 43 44 45 46 48 54 76 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'jNlXOKagLV'	42537.4335185185	0	43	[100 101 102 103 44 45 46 48 54 76 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'KgCe5R1jGh'	42537.4335300926	1	41	[100 101 102 103 41 44 45 46 54 76 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'V0n5xelYK1'	42537.4335300926	0	48	[100 101 102 103 44 45 46 54 76 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'OyG4y88fgG'	42537.4335532407	1	104	[100 101 102 103 104 41 44 45 46 54 76 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'QOHjh9KEuJ'	42537.4335648148	1	57	[100 101 102 103 104 41 44 45 46 54 57 76 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'Mng6qNSuO7'	42537.4336111111	0	54	[100 101 102 103 104 41 44 45 46 57 76 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'0HsdWsfYMt'	42537.4336226852	0	103	[100 101 102 104 41 44 45 46 57 76 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'xixHhdRAB4'	42537.4336342593	1	43	[100 101 102 104 41 43 44 45 46 57 76 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'GAeuqE0xVh'	42537.4336458333	0	41	[100 101 102 104 43 44 45 46 57 76 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'GLK22NIbW1'	42537.4336574074	1	49	[100 101 102 104 43 44 45 46 49 57 76 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'obcpBHlgeT'	42537.4336805556	0	57	[100 101 102 104 43 44 45 46 49 76 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'2QxTCXSNN2'	42537.4336921296	0	104	[100 101 102 43 44 45 46 49 76 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'W7zMU6Sn3I'	42537.4337037037	0	75	[100 101 102 43 44 45 46 49 76 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'GEb0KL200o'	42537.4337500000	1	77	[100 101 102 43 44 45 46 49 76 77 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'tFq3w13YOO'	42537.4337500000	0	54	[100 101 102 43 44 45 46 49 76 77 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'm8t8J7nlVR'	42537.4337615741	1	57	[100 101 102 43 44 45 46 49 57 76 77 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'wwltEUkaHy'	42537.4337731482	0	41	[100 101 102 43 44 45 46 49 57 76 77 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'7p1gpqJErx'	42537.4337962963	1	56	[100 101 102 43 44 45 46 49 56 57 76 77 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'jbJ6xfWpjV'	42537.4338078703	0	42	[100 101 102 43 44 45 46 49 56 57 76 77 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'nnEDeABnms'	42537.4338541667	0	102	[100 101 43 44 45 46 49 56 57 76 77 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'jxISbtxraP'	42537.4338773148	0	46	[100 101 43 44 45 49 56 57 76 77 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'nJig8d4bl4'	42537.4338888889	1	78	[100 101 43 44 45 49 56 57 76 77 78 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'Q8qO4ckIcw'	42537.4339004630	0	76	[100 101 43 44 45 49 56 57 77 78 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'S5J7jOisjt'	42537.4339004630	0	54	[100 101 43 44 45 49 56 57 76 77 78 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'baJbtn81nv'	42537.4339120370	1	58	[100 101 43 44 45 56 57 58 77 78 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'cC4zWr5m4e'	42537.4339120370	0	49	[100 101 43 44 45 56 57 77 78 81 83 84 86 87 89 90 91 94 95 96 97 98 99]
'9E1aVv8etf'	42537.4339236111	1	82	[100 101 43 44 45 56 57 58 77 78 81 82 83 84 86 87 89 90 91 94 95 96 97 98 99]
'L7GogaFMBl'	42537.4339236111	1	61	[100 101 43 44 45 56 57 58 61 77 78 81 82 83 84 86 87 89 90 91 94 95 96 97 98 99]
'xF1HXFs5ne'	42537.4339351852	0	45	[100 101 43 44 56 57 58 61 77 78 81 82 83 84 86 87 89 90 91 94 95 96 97 98 99]
'4ArTnS2kmJ'	42537.4339699074	1	79	[100 101 43 44 56 57 58 61 77 78 79 81 82 83 84 86 87 89 90 91 94 95 96 97 98 99]
'E0RcMzJ3Ke'	42537.4339814815	1	41	[100 101 41 43 44 56 57 58 61 77 78 79 81 82 83 84 86 87 89 90 91 94 95 96 97 98 99]
'vskoIpaSCc'	42537.4340162037	0	78	[100 101 41 43 44 56 57 58 61 77 79 81 82 83 84 86 87 89 90 91 94 95 96 97 98 99]
'FLBc9OrEJp'	42537.4340393519	0	48	[100 101 41 43 44 56 57 58 61 77 79 81 82 83 84 86 87 89 90 91 95 96 97 98 99]
'UyZuFNzXhl'	42537.4340393519	0	94	[100 101 41 43 44 56 57 58 61 77 79 81 82 83 84 86 87 89 90 91 95 96 97 98 99]
'z4MmpISKdH'	42537.4340393519	1	40	[100 101 40 41 43 44 56 57 58 61 77 79 81 82 83 84 86 87 89 90 91 95 96 97 98 99]
'XXQhYJvOYJ'	42537.4340509259	0	61	[100 101 102 40 41 43 44 56 57 58 77 79 81 83 84 86 87 89 90 91 95 96 97 98 99]
'nTnBYUm9Nc'	42537.4340509259	1	104	[100 101 102 104 40 41 43 44 56 57 58 77 79 81 83 84 86 87 89 90 91 95 96 97 98 99]
'o9lOQQOo2o'	42537.4340509259	0	82	[100 101 102 40 41 43 44 56 57 58 61 77 79 81 83 84 86 87 89 90 91 95 96 97 98 99]
'sJG9fnxwrM'	42537.4340509259	1	102	[100 101 102 40 41 43 44 56 57 58 61 77 79 81 82 83 84 86 87 89 90 91 95 96 97 98 99]
'OMTKwXGmur'	42537.4340740741	0	83	[100 101 102 104 40 41 43 44 56 57 58 77 79 81 84 86 87 89 90 91 95 96 97 98 99]
'Qbmb5YcQkq'	42537.4340856482	0	57	[100 101 102 104 40 41 43 44 56 58 77 79 84 86 87 89 90 91 95 96 97 98 99]
'ZrUGPHrqiZ'	42537.4340856482	0	81	[100 101 102 104 40 41 43 44 56 57 58 77 79 84 86 87 89 90 91 95 96 97 98 99]
'8h0ZTaklVh'	42537.4340972222	0	53	[100 101 102 104 40 41 43 44 56 58 77 79 84 86 87 89 90 91 95 96 97 98 99]
'kRIRSziGjj'	42537.4341203704	0	44	[100 101 102 104 40 41 43 56 58 77 79 84 86 87 89 90 91 95 96 97 98 99]
'ECXvpj89Gl'	42537.4341319444	0	84	[100 101 102 104 40 41 43 56 58 77 79 86 87 89 90 91 95 96 97 98 99]
'VNfdTyu7e2'	42537.4341435185	0	43	[100 101 102 104 40 41 58 77 79 86 87 89 90 91 95 96 97 98 99]
'o3ONu3KL4Z'	42537.4341435185	0	56	[100 101 102 104 40 41 43 58 77 79 86 87 89 90 91 95 96 97 98 99]
'TMZo5kwvXN'	42537.4341550926	0	89	[100 101 102 104 40 41 58 77 79 86 87 90 91 95 96 97 98 99]
'YG2XkuWcee'	42537.4341550926	0	86	[100 101 102 104 40 41 58 77 79 87 90 91 95 96 97 98 99]
'AcH1DTjifU'	42537.4341666667	0	40	[100 101 102 104 41 58 77 79 87 90 91 95 96 97 98 99]
'ABXmcyTXTl'	42537.4341782407	0	58	[100 101 102 104 41 77 79 87 90 91 96 97 98 99]
'U0dUxQzf18'	42537.4341782407	0	104	[100 101 102 41 77 79 87 90 91 96 97 98 99]
'tX8n9vYCt6'	42537.4341782407	0	95	[100 101 102 104 41 58 77 79 87 90 91 96 97 98 99]
'67ycT2Y4Mg'	42537.4341898148	0	42	[100 101 102 103 38 41 77 79 87 90 91 96 97 98 99]
'OZL22x8KFz'	42537.4341898148	1	38	[100 101 102 103 38 41 77 79 87 90 91 96 97 98 99]
'ntTfMbN3mE'	42537.4341898148	1	103	[100 101 102 103 41 77 79 87 90 91 96 97 98 99]
'Q9RSdhhezQ'	42537.4342013889	0	102	[100 101 103 38 41 77 79 87 90 91 96 97 98 99]
'xepyS1ozYL'	42537.4342013889	1	57	[100 101 103 38 41 57 77 79 87 90 91 96 97 98 99]
'7uD6drSW9g'	42537.4342129630	0	87	[100 101 103 38 41 57 77 79 90 91 96 97 98 99]
'BgueVPH8J3'	42537.4342129630	0	85	[100 101 103 38 41 57 77 79 87 90 91 96 97 98 99]
'q8YyzlIykJ'	42537.4342361111	0	79	[100 101 103 38 41 57 77 91 96 97 98 99]
'tksrW6J7tQ'	42537.4342361111	0	90	[100 101 103 38 41 57 77 79 91 96 97 98 99]
'kdOIlXvwci'	42537.4342824074	0	41	[100 101 103 38 57 77 91 96 97 98 99]
'Aol5hEwyKp'	42537.4343055556	1	85	[100 101 102 103 38 57 77 85 91 96 97 98 99]
'Nir2QcG5b5'	42537.4343055556	1	102	[100 101 102 103 38 57 77 91 96 97 98 99]
'iI71zvyq0o'	42537.4343055556	1	87	[100 101 102 103 38 57 77 85 87 91 96 97 98 99]
'3JW8eftdiD'	42537.4343171296	0	88	[100 101 102 103 38 57 77 85 87 91 96 97 98 99]
'Q0D36WxYqG'	42537.4343171296	1	84	[100 101 102 103 38 57 77 84 85 87 91 95 96 97 98 99]
'XKEzcWa02W'	42537.4343171296	1	95	[100 101 102 103 38 57 77 85 87 91 95 96 97 98 99]
'8tzXiQxbo7'	42537.4343287037	1	89	[100 101 102 103 38 77 84 85 87 89 91 95 96 97 98 99]
'm6b1H2ycQU'	42537.4343287037	0	57	[100 101 102 103 38 77 84 85 87 91 95 96 97 98 99]
'3n4ClpEMap'	42537.4343402778	1	42	[100 101 102 103 38 42 84 85 87 89 91 95 96 97 98 99]
'jiHDdAMSpc'	42537.4343402778	0	77	[100 101 102 103 38 84 85 87 89 91 95 96 97 98 99]
'ZCl3dTR0Q2'	42537.4343518519	0	38	[100 101 102 103 42 84 85 87 89 91 95 96 97 98 99]
'qE7pjYyd2n'	42537.4343634259	1	79	[100 101 102 103 42 79 84 85 87 89 91 95 96 97 98 99]
'C1YWdrIZAE'	42537.4343750000	1	86	[100 101 102 103 42 79 84 85 86 87 89 91 95 96 97 98 99]
'xajPt2Xavc'	42537.4343865741	1	104	[100 101 102 103 104 42 79 84 85 86 87 89 91 95 96 97 98 99]
'bjs0dQVUJx'	42537.4343981482	1	78	[100 101 102 103 104 42 78 79 84 85 86 87 89 91 95 96 97 98 99]
'Ptu5vgbZR8'	42537.4344328704	1	43	[100 101 102 103 104 42 43 78 79 84 85 86 87 89 91 95 96 97 98 99]
'yg8w0K6QHL'	42537.4344560185	0	75	[100 101 102 103 104 42 43 78 79 84 85 86 87 89 91 95 96 97 98 99]
'8rqNqKRVc2'	42537.4344675926	0	87	[100 101 102 103 104 42 43 78 79 84 85 86 89 91 95 96 97 98 99]
'ByFGvuAxJE'	42537.4344791667	0	85	[100 101 102 103 104 42 43 78 79 84 86 89 91 95 96 97 98 99]
'kBJtc0XJcc'	42537.4344791667	0	79	[100 101 102 103 104 42 43 78 84 86 89 91 95 96 97 98 99]
'CmVdd3Chr9'	42537.4344907407	0	86	[100 101 102 103 104 42 43 78 84 89 91 95 96 97 98 99]
'w9BEx0qNN3'	42537.4344907407	0	88	[100 101 102 103 104 42 43 78 84 86 89 91 95 96 97 98 99]
'LdOs8sQtLv'	42537.4345138889	1	80	[100 101 102 103 104 42 43 78 80 84 89 91 95 96 97 98 99]
'2aq9vauFFg'	42537.4345254630	0	78	[100 101 102 103 104 42 43 80 84 89 91 95 96 97 98 99]
'gje11j8Xap'	42537.4345254630	1	75	[100 101 102 103 104 42 43 75 80 84 89 91 95 96 97 98 99]
'6KaucxNmoc'	42537.4345486111	0	43	[100 101 102 103 104 42 75 80 84 89 91 95 96 97 98 99]
'GozGLIyvbo'	42537.4345717593	0	89	[100 101 102 103 104 42 75 80 84 91 95 96 97 98 99]
'A7nOxYgicd'	42537.4345949074	0	87	[100 101 102 103 104 42 75 80 84 91 95 96 97 98 99]
'2BeIfNkZDk'	42537.4346180556	0	84	[100 101 102 103 104 42 75 80 91 95 96 97 98 99]
'4ZV9q1ymsv'	42537.4346296296	1	92	[100 101 102 103 104 42 75 80 91 92 95 96 97 98 99]
'0PpEyLQRwc'	42537.4346412037	0	80	[100 101 102 103 104 42 75 91 92 95 96 97 98 99]
'9uNH5OrU3E'	42537.4346412037	0	56	[100 101 102 103 104 42 75 91 92 95 96 97 98 99]
'3at9M4XKbL'	42537.4346527778	0	104	[100 101 102 103 42 75 91 92 95 96 97 98 99]
'dA047oqkoo'	42537.4346527778	1	6	[100 101 102 103 42 6 75 91 92 95 96 97 98 99]
'tipTVm0pmY'	42537.4346759259	1	81	[100 101 102 103 42 6 75 81 91 92 95 96 97 98 99]
'uYvaZctSY6'	42537.4346759259	0	78	[100 101 102 103 42 6 75 81 91 92 95 96 97 98 99]
'1OgQLOHrlY'	42537.4346875000	1	2	[100 101 102 103 2 42 6 75 81 91 92 95 96 97 98 99]
'qDQhl7Vom7'	42537.4346875000	0	41	[100 101 102 103 2 42 6 75 81 91 92 95 96 97 98 99]
'y5sCFJWDZb'	42537.4346875000	0	42	[100 101 102 103 2 6 75 81 91 92 95 96 97 98 99]
'JW8iprlVxO'	42537.4347337963	1	86	[100 101 102 103 2 6 75 81 86 91 92 95 96 97 98 99]
'cbtXBHXuJO'	42537.4347337963	0	89	[100 101 102 103 2 6 75 81 91 92 95 96 97 98 99]
'y4iMgNqr6S'	42537.4347453704	0	88	[100 101 102 103 2 6 75 81 86 91 92 95 96 97 98 99]
'afll2hDe8v'	42537.4347569444	0	92	[100 101 102 103 2 6 75 81 86 91 95 96 97 98 99]
'Hq94ybTx5U'	42537.4347685185	0	91	[100 101 102 103 2 6 63 75 81 86 95 96 97 98 99]
'po3vmd9Kvj'	42537.4347685185	1	63	[100 101 102 103 2 6 63 75 81 86 91 95 96 97 98 99]
'5Z3KadpsRH'	42537.4347800926	0	6	[100 101 102 103 2 63 75 81 86 95 96 97 98 99]
'OJyON5b5Te'	42537.4347800926	0	85	[100 101 102 103 2 6 63 75 81 86 95 96 97 98 99]
'0u11IKEc1U'	42537.4347916667	0	97	[100 101 102 103 2 38 63 75 81 86 95 96 98 99]
'YL9ezN90hl'	42537.4347916667	1	38	[100 101 102 103 2 38 63 75 81 86 95 96 97 98 99]
'eWe9UAk9tt'	42537.4347916667	0	96	[100 101 102 2 38 63 75 81 86 95 98 99]
'prdNRCX03S'	42537.4347916667	0	103	[100 101 102 2 38 63 75 81 86 95 96 98 99]
'JKQF91Y5UG'	42537.4348032407	1	104	[100 101 104 2 38 63 75 81 86 95 98 99]
'eUTSjNups8'	42537.4348032407	0	102	[100 101 2 38 63 75 81 86 95 98 99]
'6BeWBdgGLt'	42537.4348148148	0	2	[100 104 38 63 75 86 95 98 99]
'V9ndRlICsn'	42537.4348148148	0	101	[100 104 2 38 63 75 81 86 95 98 99]
'bp04yv6F4v'	42537.4348148148	0	81	[100 104 2 38 63 75 86 95 98 99]
'vomUSV3HsE'	42537.4348148148	1	78	[100 104 38 52 63 75 78 86 95 98 99]
'yEvcYYjJmt'	42537.4348148148	1	52	[100 104 38 52 63 75 86 95 98 99]
'C9vO6ZzGO4'	42537.4348263889	0	80	[100 104 38 52 63 75 78 86 95 98 99]
'BlUOjNVh75'	42537.4348495370	1	35	[100 104 35 38 52 63 75 78 86 98 99]
'knNtEOn0qe'	42537.4348495370	0	95	[100 104 38 52 63 75 78 86 98 99]
'm6xAlOUrsq'	42537.4348611111	0	86	[100 104 35 38 52 63 75 78 98 99]
'sIGVuwQvya'	42537.4348611111	0	87	[100 104 35 38 52 63 75 78 86 98 99]
'wMwFLmoHdx'	42537.4348611111	0	75	[100 104 35 38 52 63 78 98 99]
'UBLkFyaFqY'	42537.4348842593	0	100	[104 35 38 52 78 98 99]
'wuqd4f8SON'	42537.4348842593	0	63	[100 104 35 38 52 78 98 99]
'BJNhEtW8C5'	42537.4348958333	1	80	[104 35 38 52 78 80 98 99]
'hiG1VEvCI7'	42537.4348958333	0	56	[104 35 38 52 78 80 98 99]
'e5un1kx0Dt'	42537.4349189815	0	90	[104 35 38 52 78 80 98 99]
't0zLWoPRep'	42537.4349189815	0	99	[104 35 38 52 78 80 98]
'nJIikICXdi'	42537.4349305556	0	77	[104 35 38 52 78 80 98]
'xUc75VruLi'	42537.4349305556	0	40	[104 35 38 52 78 80 98]
'3SGKzuIJ9E'	42537.4349421296	0	102	[35 38 52 78 80 98]
'bSU86OalPO'	42537.4349421296	0	104	[35 38 52 78 80 98]
'oP8DU0drwe'	42537.4349421296	0	103	[104 35 38 52 78 80 98]
'9EBZWfSnQp'	42537.4349537037	0	38	[35 52 78 80]
'DwzfI8dVoH'	42537.4349537037	0	91	[35 38 52 78 80]
'i3j7Eb7HTN'	42537.4349537037	0	98	[35 38 52 78 80]
'i5aoO6E4SU'	42537.4349537037	1	75	[35 52 75 78 80]
'XC4hLTsxR2'	42537.4349768519	0	35	[52 75 78 80]
'0MbxvgZa78'	42537.4349884259	0	2	[52 75 80]
'TH95RCvDfH'	42537.4349884259	0	78	[52 75 80]
'jYlsngrnwT'	42537.4350000000	0	101	[52 75 80]
's1rlsfxPFJ'	42537.4350347222	1	64	[52 64 75 80]
'pL7tXVtL6C'	42537.4350462963	0	52	[64 75 80]
'2AGb1zmqpI'	42537.4350694444	0	75	[64 80]
'qoZQJUodUr'	42537.4351157407	1	61	[61 64 77 80]
'yYSx96TZDQ'	42537.4351157407	1	77	[64 77 80]
'ahhyoxVPrw'	42537.4351504630	1	62	[61 62 64 77]
'owTbnLcPI3'	42537.4351504630	0	80	[61 64 77]
'SPpCarFl1u'	42537.4351620370	0	64	[61 62 77]
'vDx5nLMYj3'	42537.4351851852	1	2	[2 61 62 77]
'rkAGwWY2nI'	42537.4352199074	1	63	[2 61 62 63 77]
'kVgZK6MFXV'	42537.4352546296	0	75	[2 61 62 63 77]
'a40CyyyogU'	42537.4353009259	0	2	[61 62 63 77]
'8sQLzzqcYJ'	42537.4353125000	1	91	[61 62 63 64 77 91]
'BXqUdgsH4F'	42537.4353125000	1	80	[61 62 63 64 77 80 91]
'QBfXnB3kEb'	42537.4353125000	0	61	[62 63 64 77 80 91]
'lWLP5sIREs'	42537.4353125000	1	64	[61 62 63 64 77]
'xsduEvSLVn'	42537.4353472222	0	63	[62 64 77 80 91]
'zqPj21BKVD'	42537.4353935185	1	38	[38 62 64 77 80 91]
'nbPWWGIZ0z'	42537.4354050926	0	77	[38 62 64 80 91]
'qIwnPcoI85'	42537.4354050926	0	75	[38 62 64 80 91]
'IIqrQg8JKt'	42537.4354282407	1	79	[38 62 64 79 80 91]
'CFmsswAIz1'	42537.4354398148	0	80	[38 62 64 79 91]
'Uip9hjrb0r'	42537.4354398148	0	62	[38 64 79 91]
'mWcewF7Juf'	42537.4354398148	0	78	[38 62 64 79 80 91]
'st4IHESjuA'	42537.4354398148	0	91	[38 64 79]
'FQrxjgQIaG'	42537.4354629630	0	61	[38 64 79]
'6DzOFidR7O'	42537.4354976852	0	64	[101 38 79]
'XiBVhr4VDv'	42537.4354976852	1	101	[101 38 64 79]
'NuzWZOQ3tZ'	42537.4355092593	0	63	[101 38 79]
'ZryYVrt1Xn'	42537.4355092593	0	38	[101 79]
'VxkazFSBHC'	42537.4355439815	1	99	[101 99]
'oQ7d8V69m0'	42537.4355439815	0	79	[101]
'Jy4r2v7nds'	42537.4355555556	1	100	[100 101 99]
'o6rZOmcvmd'	42537.4355555556	1	102	[100 101 102 99]
'q2RAspIXeJ'	42537.4355555556	1	52	[100 101 102 52 99]
'r1gUuYsVux'	42537.4355671296	1	104	[100 101 102 104 52 99]
'WzZI1pWaFR'	42537.4355787037	0	77	[100 101 102 104 52 99]
'6WBe50qg8j'	42537.4356018519	1	75	[100 101 102 104 52 75 99]
'EM8AiZrlq3'	42537.4356018519	1	78	[100 101 102 104 52 75 78 99]
'ZVELFQASsV'	42537.4356134259	0	62	[100 101 102 104 52 75 78 99]
'0IJoifoWgO'	42537.4356481481	1	51	[100 101 102 104 51 52 75 78 99]
'USaY6Q5OJT'	42537.4356481481	1	103	[100 101 102 103 104 51 52 75 78 99]
'p5r9FsUgFV'	42537.4356597222	1	36	[100 101 102 103 104 36 51 52 75 78 99]
'9mP0JedcGx'	42537.4356712963	0	99	[100 101 102 103 104 36 51 52 75 78]
'hIysPUfPMD'	42537.4356828704	0	79	[100 101 102 103 104 36 51 52 75 78]
'cu9retbx2B'	42537.4357060185	0	91	[100 101 102 103 104 36 51 52 75 78]
'3NbCqOnDMw'	42537.4357291667	1	55	[100 101 102 103 104 36 51 52 55 75 78]
'QUymQoNske'	42537.4357407407	1	35	[100 101 102 103 104 35 36 51 52 55 75 78]
'M0Q7OZrD8V'	42537.4357638889	1	34	[100 101 102 103 104 34 35 36 51 52 55 75 78]
'nw4GWTtdYM'	42537.4357638889	1	50	[100 101 102 103 104 34 35 36 50 51 52 55 75 78]
'RbowbzKQID'	42537.4357754630	1	80	[100 101 102 103 104 34 35 36 50 51 52 55 75 78 80]
'QnHaSuUlhQ'	42537.4357870370	1	98	[100 101 102 103 104 34 35 36 50 51 52 55 75 78 80 98]
'06p9Si7uh1'	42537.4357986111	1	2	[100 101 102 103 104 2 34 35 36 50 51 55 75 78 80 98 99]
'2eVuFPWxiN'	42537.4357986111	0	52	[100 101 102 103 104 34 35 36 50 51 55 75 78 80 98 99]
'yb4YORvneR'	42537.4357986111	1	99	[100 101 102 103 104 34 35 36 50 51 52 55 75 78 80 98 99]
'w8jr7ru7mp'	42537.4358101852	1	32	[100 101 102 103 104 2 32 34 35 36 50 51 55 75 78 80 98 99]
'MivEDqF5Je'	42537.4358796296	0	35	[100 101 102 103 104 2 32 34 36 50 51 55 75 78 80 98 99]
'UyPyCog4OR'	42537.4358912037	1	31	[100 101 102 103 104 2 31 32 34 36 50 51 55 75 78 80 98 99]
'ICZ4zrPv1W'	42537.4359143519	0	75	[100 101 102 103 104 2 31 32 34 36 50 51 55 78 80 99]
'fUIdF8wp5i'	42537.4359143519	0	98	[100 101 102 103 104 2 31 32 34 36 50 51 55 75 78 80 99]
'QFHCZkD1Kc'	42537.4359259259	0	2	[100 101 102 103 104 31 32 34 36 50 51 55 78 80 99]
'HoyGytbu4T'	42537.4359375000	1	35	[100 101 102 103 104 31 32 34 35 36 50 51 55 78 80 99]
'Q7n19n3UC9'	42537.4359490741	0	76	[100 101 102 103 104 31 32 34 35 36 50 51 55 78 80 99]
'oeHzIervNE'	42537.4359606481	0	36	[100 101 102 103 104 31 32 34 35 50 51 55 78 80 99]
'LItKtOzxqv'	42537.4359837963	1	91	[100 101 102 103 104 31 32 34 35 50 51 55 78 80 91 98 99]
'Rvdw28m1Gw'	42537.4359837963	1	98	[100 101 102 103 104 31 32 34 35 50 51 55 78 80 98 99]
'q4zVjVL9TJ'	42537.4359953704	0	80	[100 101 102 103 104 31 32 34 35 50 51 55 78 91 98 99]
'tkifCQw6uH'	42537.4360069444	0	34	[100 101 102 103 104 31 32 35 50 51 55 78 91 98 99]
'tMOAqaU83z'	42537.4360300926	1	36	[100 101 102 103 104 31 32 35 36 50 51 55 78 91 98 99]
'naz4BC80JM'	42537.4360416667	1	97	[100 101 102 103 104 31 32 35 36 50 51 55 78 91 97 98 99]
'68GMtyv3qs'	42537.4360532407	1	95	[100 101 102 103 104 31 32 35 36 50 51 55 78 91 95 97 98 99]
'6GPQ9TdOCO'	42537.4360879630	0	77	[100 101 102 103 104 31 32 35 36 50 51 55 91 95 97 98 99]
'tz9jbiyJTQ'	42537.4360879630	0	78	[100 101 102 103 104 31 32 35 36 50 51 55 91 95 97 98 99]
'Kw29hz9mSO'	42537.4360995370	0	100	[101 102 103 104 31 32 35 36 50 51 55 91 95 97 98 99]
'WIeXvL8s4b'	42537.4361111111	0	55	[101 102 103 104 31 32 35 36 50 51 91 95 97 98 99]
'mMvcUuymqS'	42537.4361111111	0	91	[101 102 103 104 31 32 35 36 50 51 95 97 98 99]
'JZhVFlBnKD'	42537.4361458333	0	31	[101 102 103 104 32 35 36 50 51 95 97 98 99]
'vlQCZnPiCL'	42537.4361574074	1	78	[101 102 103 104 32 35 36 50 51 78 95 97 98 99]
'7M0FfpgH2D'	42537.4361689814	0	99	[101 102 103 104 32 35 36 50 51 78 98]
'B9RmfYyERG'	42537.4361689814	0	97	[101 102 103 104 32 35 36 50 51 78 98 99]
'bs2mLRJIce'	42537.4361689814	0	95	[101 102 103 104 32 35 36 50 51 78 97 98 99]
'xhanHprvjx'	42537.4361689814	0	34	[101 102 103 104 32 35 36 50 51 78 98 99]
'Dhqls5uWoh'	42537.4361805556	1	100	[100 101 102 103 104 32 35 36 50 51 78 98]
'n3OBYwkN0U'	42537.4362384259	1	75	[100 101 102 103 104 32 35 36 50 51 75 78 98]
'KoakgEZW2N'	42537.4362615741	0	36	[100 101 102 103 104 32 35 50 51 75 78 98]
'0CRQi9PSHj'	42537.4362731481	1	90	[100 101 102 103 104 32 35 50 51 75 78 90 98]
'NXchGKWAtU'	42537.4362847222	1	97	[100 101 102 103 104 32 35 50 51 75 78 90 97 98]
'VVlNarB9Xp'	42537.4362847222	0	35	[100 101 102 103 104 32 50 51 75 78 90 97 98]
'p7YjolnwdC'	42537.4362962963	1	95	[100 101 102 103 104 32 50 51 75 78 90 95 97 98]
'BBMtRlBrlJ'	42537.4363310185	1	99	[100 101 102 103 104 32 50 51 75 78 90 95 97 98 99]
'B1lMh1O0Gp'	42537.4363425926	0	50	[100 101 102 103 104 32 51 75 78 90 95 97 98 99]
'm0QLRcHS7L'	42537.4363541667	0	76	[100 101 102 103 104 32 51 75 78 90 95 97 98 99]
'vE2LViRRDF'	42537.4363657407	0	34	[100 101 102 103 104 32 51 75 78 90 95 97 98 99]
'43kDobIZwp'	42537.4363888889	0	90	[100 101 102 103 104 32 51 75 78 95 97 98 99]
'DhWAFww0Rz'	42537.4364004630	1	35	[100 101 102 103 104 32 35 51 75 78 95 97 98 99]
};


in_timestamps = cell2mat(data(find(cell2mat(data(:,3))==[1]),[2 4]));
%uniformaly sampling data
p = 1/86400;  % 1 second in a day
tstamps = cell2mat(data(:,2));
sampled = {};
for t = min(tstamps)+p:p:max(tstamps) + p
    tags = data(max(find (cell2mat(data(:,2))<t)),5);
    sampled(end+1,1:2) = [t tags];
end


trajectory = [];

 for n=1:length(sampled)
     t=cell2mat(sampled(n));
     coverage = cell2mat(sampled(n,2));
      coverage = transpose(intersect(coverage, beacons));
%       coverage = transpose(intersect (coverage,in_timestamps(:,2)))
     if size(coverage) > 0
%           % Hierarchical filtering
        if numel(coverage) > 1
             X = beacons(ismember(beacons(:,1),transpose(coverage)), 1:3);
             Y = pdist(X(:,2:3));
             Z = linkage(Y);
             T = cluster(Z,'maxclust',2);
             if size(T(T==1)) >= size(T(T==2))
                 culster_id = 1;
             else
                 culster_id = 2;
             end
             original_coverage = coverage
             coverage = transpose (intersect(X(T==culster_id), coverage))
%           % end filtering
        end 
         
         last_in = [];
         for tag = coverage
             appeared_on = in_timestamps(max(find(in_timestamps(:,2)==tag & in_timestamps(:,1) <= t)));

             if isempty(appeared_on)
                 appeared_on = min(cell2mat(sampled(:,1)));
             end
             last_in(end+1,1) = appeared_on;
         end
    %      last_in= (last_in*1000) - min(last_in)
         if size(coverage) <=3
             last_in(:,1) = 1;
         else
                if range(last_in) == 0
                    last_in(:,1) = 1;
                else
                    last_in = last_in - min(last_in);
                    last_in = last_in/sum(last_in) * 100;
                end

         end
     
     
%          avg_x = mean (beacons(ismember(beacons(:,1),transpose(coverage)), 2));
%          avg_y = mean (beacons(ismember(beacons(:,1),transpose(coverage)), 3));
%          x(end+1) = avg_x;
%          y(end+1) = avg_y;

         wavg_x = sum (beacons(ismember(beacons(:,1),transpose(coverage)), 2) .* last_in)/sum(last_in);
          wavg_y = sum (beacons(ismember(beacons(:,1),transpose(coverage)), 3) .* last_in)/sum(last_in);
          trajectory(end+1,:) = [t, wavg_x, wavg_y];
          
     end
 end


% x=[];
% y=[];
% lookAhead = 2;
% for n=1:length(data)-lookAhead
%     coverage = cell2mat(data(n,5));
%     for l=1:lookAhead
%         coverage = intersect(coverage, cell2mat(data(n+l,5)));
%     end
%     if size(coverage)< 4
%         coverage = cell2mat(data(n,5));
%     end
%     if size(coverage) > 0
%         avg_x = mean(beacons(ismember(beacons(:,1),transpose(coverage)), 2));
%         avg_y = mean(beacons(ismember(beacons(:,1),transpose(coverage)), 3));
%         x(end+1) = avg_x;
%         y(end+1) = avg_y;
%     end
% end

x = trajectory(:,2);
y = trajectory(:,3);

Y= dct(y);Y1=Y;Y1(11:end)=0;y1 = idct(Y1);
X= dct(x);X1=X;X1(11:end)=0;x1 = idct(X1);
plot(x, y,'r','LineWidth',2);


        
legend('Ground Truth', 'Estimated Trajectory')

[x1 y1]